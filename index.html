<!DOCTYPE html>
<html>
<body>
    <h1>Geolocation API</h1>
    <button onclick="myFunc1()">Get Your Location!</button><br><br>
    <button onclick="startLive()">Start Your Live Location</button>
    <button onclick="stopLive()">Stop Live Location</button><br><br>
    <p id="para"></p>
    <script>
        // Locate the User's Position

        // Using the Geolocation API
        // The getCurrentPosition() method is used to return the user's position.
        function myFunc1() {
            if (window.navigator.geolocation) { // checking if supported
                let position = navigator.geolocation.getCurrentPosition(position => {
                    console.log(`Latitude: ${position.coords.latitude}, Longitude: ${position.coords.longitude}`);
                }, errorHandler);
            } else {
                console.log("Not Supported");
            }
        }

        // Handling Errors and Rejections
        // The second parameter of the getCurrentPosition() method is used to handle errors. 
        // It specifies a function to run if it fails to get the user's location.
        function errorHandler(error) {
            console.log(error.message);
            switch (error.code) {
                case error.PERMISSION_DENIED:
                    console.log("User denied the request for Geolocation.");
                    break;
                case error.POSITION_UNAVAILABLE:
                    console.log("Location information is unavailable.");
                    break;
                case error.TIMEOUT:
                    console.log("The request to get user location timed out.");
                    break;
                case error.UNKNOWN_ERROR:
                    console.log("An unknown error occurred.");
            }
        }

        // watchPosition() - Returns the current position of the user and continues to 
        // return updated position as the user moves (like the GPS in a car).
        // clearWatch() - Stops the watchPosition() method.
        // You need an accurate GPS device to test this (like smartphone).

        var livePosition;

        function startLive() {
            const para = document.getElementById('para');
            let livePosition = navigator.geolocation.watchPosition(position => {
                console.log(1);
                para.innerHTML = `Latitude: ${position.coords.latitude}, Longitude: ${position.coords.longitude}`;
            });
        }

        function stopLive() {
            const para = document.getElementById('para');
            para.innerHTML = 'Stopped';
            navigator.geolocation.clearWatch(livePosition);
        }
    </script>
</body>
</html>